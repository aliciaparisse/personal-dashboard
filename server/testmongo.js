/**
 * Created by parisse on 29.3.2016.
 */
var express = require('express');
var MongoClient = require('mongodb').MongoClient
    , assert = require('assert');



var averageUser =[
    { userId: 'averageUser', date: '2015-10-26', nbEx: 9.1 },
    { userId: 'averageUser', date: '2015-10-28', nbEx: 11.6 },
    { userId: 'averageUser', date: '2015-11-05', nbEx: 7.2 },
    { userId: 'averageUser', date: '2015-11-09', nbEx: 8.7 },
    { userId: 'averageUser', date: '2015-11-14', nbEx: 7.2 },
    { userId: 'averageUser', date: '2015-11-18', nbEx: 8.5 },
    { userId: 'averageUser', date: '2015-11-22', nbEx: 10.3 },
    { userId: 'averageUser', date: '2015-11-23', nbEx: 7.6 },
    { userId: 'averageUser', date: '2015-11-19', nbEx: 7.8 },
    { userId: 'averageUser', date: '2015-11-24', nbEx: 8.6 },
    { userId: 'averageUser', date: '2015-11-26', nbEx: 8.7 },
    { userId: 'averageUser', date: '2015-11-28', nbEx: 12.1 },
    { userId: 'averageUser', date: '2015-11-29', nbEx: 10.3 },
    { userId: 'averageUser', date: '2015-11-30', nbEx: 10.3 },
    { userId: 'averageUser', date: '2015-12-01', nbEx: 10.7 },
    { userId: 'averageUser', date: '2015-12-02', nbEx: 9.5 },
    { userId: 'averageUser', date: '2015-12-07', nbEx: 12.7 },
    { userId: 'averageUser', date: '2015-12-03', nbEx: 9.7 },
    { userId: 'averageUser', date: '2015-12-04', nbEx: 8.8 },
    { userId: 'averageUser', date: '2015-12-08', nbEx: 12.6 },
    { userId: 'averageUser', date: '2015-12-09', nbEx: 16.1 },
    { userId: 'averageUser', date: '2015-12-10', nbEx: 28.9 },
    { userId: 'averageUser', date: '2016-04-14', nbEx: 6 },
    { userId: 'averageUser', date: '2015-11-02', nbEx: 10.5 },
    { userId: 'averageUser', date: '2015-10-27', nbEx: 10.7 },
    { userId: 'averageUser', date: '2015-10-29', nbEx: 12.9 },
    { userId: 'averageUser', date: '2015-10-30', nbEx: 11.4 },
    { userId: 'averageUser', date: '2016-04-09', nbEx: 6.6 },
    { userId: 'averageUser', date: '2016-04-10', nbEx: 4.8 },
    { userId: 'averageUser', date: '2016-04-11', nbEx: 10.4 },
    { userId: 'averageUser', date: '2015-11-03', nbEx: 9.8 },
    { userId: 'averageUser', date: '2015-11-04', nbEx: 7.1 },
    { userId: 'averageUser', date: '2015-11-06', nbEx: 8.9 },
    { userId: 'averageUser', date: '2015-11-07', nbEx: 10.4 },
    { userId: 'averageUser', date: '2015-11-08', nbEx: 9.8 },
    { userId: 'averageUser', date: '2015-10-31', nbEx: 9.5 },
    { userId: 'averageUser', date: '2015-11-01', nbEx: 9.2 },
    { userId: 'averageUser', date: '2015-11-13', nbEx: 10.6 },
    { userId: 'averageUser', date: '2015-11-15', nbEx: 10.5 },
    { userId: 'averageUser', date: '2015-11-21', nbEx: 7.8 },
    { userId: 'averageUser', date: '2015-11-10', nbEx: 8.1 },
    { userId: 'averageUser', date: '2015-11-11', nbEx: 8.9 },
    { userId: 'averageUser', date: '2015-11-20', nbEx: 7.8 },
    { userId: 'averageUser', date: '2015-11-27', nbEx: 9 },
    { userId: 'averageUser', date: '2015-10-25', nbEx: 10.2 },
    { userId: 'averageUser', date: '2015-11-12', nbEx: 8.1 },
    { userId: 'averageUser', date: '2015-11-17', nbEx: 8.7 },
    { userId: 'averageUser', date: '2015-11-25', nbEx: 9.4 },
    { userId: 'averageUser', date: '2015-11-16', nbEx: 9.5 },
    { userId: 'averageUser', date: '2015-12-05', nbEx: 13 },
    { userId: 'averageUser', date: '2015-12-06', nbEx: 13.6 },
    { userId: 'averageUser', date: '2015-10-23', nbEx: 10 },
    { userId: 'averageUser', date: '2015-10-24', nbEx: 11 },
    { userId: 'averageUser', date: '2016-05-11', nbEx: 7.9 },
    { userId: 'averageUser', date: '2016-04-17', nbEx: 7.4 },
    { userId: 'averageUser', date: '2016-04-23', nbEx: 5.1 },
    { userId: 'averageUser', date: '2016-05-02', nbEx: 10.5 },
    { userId: 'averageUser', date: '2016-04-15', nbEx: 5.8 },
    { userId: 'averageUser', date: '2016-04-16', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-04-25', nbEx: 9.6 },
    { userId: 'averageUser', date: '2016-04-26', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-04-30', nbEx: 6.5 },
    { userId: 'averageUser', date: '2016-05-01', nbEx: 5 },
    { userId: 'averageUser', date: '2016-05-04', nbEx: 9.6 },
    { userId: 'averageUser', date: '2016-05-05', nbEx: 7.6 },
    { userId: 'averageUser', date: '2016-05-06', nbEx: 6.4 },
    { userId: 'averageUser', date: '2016-05-07', nbEx: 8.4 },
    { userId: 'averageUser', date: '2016-05-08', nbEx: 8.4 },
    { userId: 'averageUser', date: '2016-05-12', nbEx: 5.2 },
    { userId: 'averageUser', date: '2015-10-22', nbEx: 17.7 },
    { userId: 'averageUser', date: '2016-04-18', nbEx: 10.7 },
    { userId: 'averageUser', date: '2016-04-19', nbEx: 5 },
    { userId: 'averageUser', date: '2016-04-27', nbEx: 6.5 },
    { userId: 'averageUser', date: '2016-05-03', nbEx: 6.5 },
    { userId: 'averageUser', date: '2016-05-09', nbEx: 7.8 },
    { userId: 'averageUser', date: '2016-05-10', nbEx: 7.7 },
    { userId: 'averageUser', date: '2016-04-28', nbEx: 5.8 },
    { userId: 'averageUser', date: '2016-04-13', nbEx: 7.4 },
    { userId: 'averageUser', date: '2016-04-12', nbEx: 6.6 },
    { userId: 'averageUser', date: '2015-10-20', nbEx: 21.7 },
    { userId: 'averageUser', date: '2015-10-21', nbEx: 19.9 },
    { userId: 'averageUser', date: '2016-04-24', nbEx: 6.2 },
    { userId: 'averageUser', date: '2016-04-29', nbEx: 6.4 },
    { userId: 'averageUser', date: '2016-04-21', nbEx: 5.4 },
    { userId: 'averageUser', date: '2016-05-13', nbEx: 2.5 },
    { userId: 'averageUser', date: '2016-04-20', nbEx: 5.2 },
    { userId: 'averageUser', date: '2016-04-22', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-04-08', nbEx: 4.2 },
    { userId: 'averageUser', date: '2016-02-25', nbEx: 4.7 },
    { userId: 'averageUser', date: '2016-02-28', nbEx: 5.6 },
    { userId: 'averageUser', date: '2016-03-06', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-02-13', nbEx: 8.8 },
    { userId: 'averageUser', date: '2016-02-18', nbEx: 6.7 },
    { userId: 'averageUser', date: '2016-02-14', nbEx: 7.2 },
    { userId: 'averageUser', date: '2016-02-15', nbEx: 11.7 },
    { userId: 'averageUser', date: '2016-02-16', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-02-12', nbEx: 7.4 },
    { userId: 'averageUser', date: '2016-02-17', nbEx: 5.7 },
    { userId: 'averageUser', date: '2016-02-21', nbEx: 8.6 },
    { userId: 'averageUser', date: '2016-02-22', nbEx: 15 },
    { userId: 'averageUser', date: '2016-02-20', nbEx: 9.6 },
    { userId: 'averageUser', date: '2016-02-23', nbEx: 8 },
    { userId: 'averageUser', date: '2016-01-27', nbEx: 5.3 },
    { userId: 'averageUser', date: '2016-02-02', nbEx: 6.5 },
    { userId: 'averageUser', date: '2016-02-03', nbEx: 5.1 },
    { userId: 'averageUser', date: '2016-02-06', nbEx: 5.9 },
    { userId: 'averageUser', date: '2016-02-08', nbEx: 9.2 },
    { userId: 'averageUser', date: '2016-02-09', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-02-19', nbEx: 5.9 },
    { userId: 'averageUser', date: '2016-01-16', nbEx: 18.9 },
    { userId: 'averageUser', date: '2016-01-18', nbEx: 9.6 },
    { userId: 'averageUser', date: '2016-01-20', nbEx: 5.7 },
    { userId: 'averageUser', date: '2016-01-22', nbEx: 7.1 },
    { userId: 'averageUser', date: '2016-01-23', nbEx: 6.9 },
    { userId: 'averageUser', date: '2016-01-25', nbEx: 8 },
    { userId: 'averageUser', date: '2016-01-29', nbEx: 5.6 },
    { userId: 'averageUser', date: '2016-01-30', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-01-31', nbEx: 5.9 },
    { userId: 'averageUser', date: '2016-02-04', nbEx: 5.6 },
    { userId: 'averageUser', date: '2016-02-05', nbEx: 6.1 },
    { userId: 'averageUser', date: '2016-01-28', nbEx: 5.8 },
    { userId: 'averageUser', date: '2016-02-01', nbEx: 8.9 },
    { userId: 'averageUser', date: '2016-02-10', nbEx: 5.3 },
    { userId: 'averageUser', date: '2016-02-11', nbEx: 5.9 },
    { userId: 'averageUser', date: '2016-01-14', nbEx: 13 },
    { userId: 'averageUser', date: '2016-01-17', nbEx: 21 },
    { userId: 'averageUser', date: '2016-01-26', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-01-19', nbEx: 8.1 },
    { userId: 'averageUser', date: '2016-01-15', nbEx: 13.4 },
    { userId: 'averageUser', date: '2016-01-24', nbEx: 6.9 },
    { userId: 'averageUser', date: '2016-02-07', nbEx: 5.3 },
    { userId: 'averageUser', date: '2016-01-21', nbEx: 7.3 },
    { userId: 'averageUser', date: '2016-01-12', nbEx: 15.2 },
    { userId: 'averageUser', date: '2016-01-13', nbEx: 19 },
    { userId: 'averageUser', date: '2015-12-12', nbEx: 12.9 },
    { userId: 'averageUser', date: '2015-12-13', nbEx: 15.8 },
    { userId: 'averageUser', date: '2015-12-14', nbEx: 18.1 },
    { userId: 'averageUser', date: '2016-03-01', nbEx: 5.8 },
    { userId: 'averageUser', date: '2016-03-03', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-02-24', nbEx: 4.4 },
    { userId: 'averageUser', date: '2016-02-26', nbEx: 4.3 },
    { userId: 'averageUser', date: '2016-02-27', nbEx: 5 },
    { userId: 'averageUser', date: '2015-12-19', nbEx: 20 },
    { userId: 'averageUser', date: '2015-12-21', nbEx: 3 },
    { userId: 'averageUser', date: '2016-01-03', nbEx: 9 },
    { userId: 'averageUser', date: '2016-01-04', nbEx: 13 },
    { userId: 'averageUser', date: '2016-01-05', nbEx: 10 },
    { userId: 'averageUser', date: '2016-01-06', nbEx: 6.5 },
    { userId: 'averageUser', date: '2016-01-07', nbEx: 26 },
    { userId: 'averageUser', date: '2016-01-08', nbEx: 3 },
    { userId: 'averageUser', date: '2016-01-09', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-01-10', nbEx: 20 },
    { userId: 'averageUser', date: '2016-01-11', nbEx: 15.4 },
    { userId: 'averageUser', date: '2015-12-26', nbEx: 28 },
    { userId: 'averageUser', date: '2015-12-28', nbEx: 10 },
    { userId: 'averageUser', date: '2015-12-29', nbEx: 6.5 },
    { userId: 'averageUser', date: '2015-12-30', nbEx: 17.7 },
    { userId: 'averageUser', date: '2015-12-31', nbEx: 7 },
    { userId: 'averageUser', date: '2016-01-01', nbEx: 4 },
    { userId: 'averageUser', date: '2016-01-02', nbEx: 14 },
    { userId: 'averageUser', date: '2016-03-07', nbEx: 9.1 },
    { userId: 'averageUser', date: '2015-12-11', nbEx: 15.7 },
    { userId: 'averageUser', date: '2015-12-15', nbEx: 16 },
    { userId: 'averageUser', date: '2016-02-29', nbEx: 11.4 },
    { userId: 'averageUser', date: '2016-03-02', nbEx: 5.4 },
    { userId: 'averageUser', date: '2015-12-20', nbEx: 2.5 },
    { userId: 'averageUser', date: '2015-12-23', nbEx: 2 },
    { userId: 'averageUser', date: '2015-12-24', nbEx: 33 },
    { userId: 'averageUser', date: '2015-12-25', nbEx: 4 },
    { userId: 'averageUser', date: '2015-12-27', nbEx: 28 },
    { userId: 'averageUser', date: '2016-03-04', nbEx: 5.3 },
    { userId: 'averageUser', date: '2016-03-05', nbEx: 5.5 },
    { userId: 'averageUser', date: '2016-03-12', nbEx: 5.8 },
    { userId: 'averageUser', date: '2016-03-13', nbEx: 5.7 },
    { userId: 'averageUser', date: '2016-03-11', nbEx: 6.7 },
    { userId: 'averageUser', date: '2016-03-20', nbEx: 5.9 },
    { userId: 'averageUser', date: '2016-03-24', nbEx: 6.4 },
    { userId: 'averageUser', date: '2016-03-19', nbEx: 6.1 },
    { userId: 'averageUser', date: '2016-03-18', nbEx: 7.1 },
    { userId: 'averageUser', date: '2016-03-26', nbEx: 6.8 },
    { userId: 'averageUser', date: '2016-03-28', nbEx: 8 },
    { userId: 'averageUser', date: '2016-03-25', nbEx: 5.9 },
    { userId: 'averageUser', date: '2015-03-01', nbEx: 17.3 },
    { userId: 'averageUser', date: '2015-03-04', nbEx: 12.4 },
    { userId: 'averageUser', date: '2015-02-28', nbEx: 13.9 },
    { userId: 'averageUser', date: '2015-02-27', nbEx: 14.5 },
    { userId: 'averageUser', date: '2015-03-03', nbEx: 20.3 },
    { userId: 'averageUser', date: '2015-03-09', nbEx: 10.8 },
    { userId: 'averageUser', date: '2015-03-08', nbEx: 23 },
    { userId: 'averageUser', date: '2015-05-08', nbEx: 18.8 },
    { userId: 'averageUser', date: '2015-05-03', nbEx: 11.2 },
    { userId: 'averageUser', date: '2015-05-04', nbEx: 9.9 },
    { userId: 'averageUser', date: '2016-03-21', nbEx: 10.9 },
    { userId: 'averageUser', date: '2016-03-22', nbEx: 6.3 },
    { userId: 'averageUser', date: '2015-03-02', nbEx: 20.9 },
    { userId: 'averageUser', date: '2012-10-14', nbEx: 45 },
    { userId: 'averageUser', date: '2016-04-06', nbEx: 6.7 },
    { userId: 'averageUser', date: '2015-09-21', nbEx: 5.8 },
    { userId: 'averageUser', date: '2015-09-22', nbEx: 5 },
    { userId: 'averageUser', date: '2015-09-10', nbEx: 8.6 },
    { userId: 'averageUser', date: '2015-09-23', nbEx: 9.9 },
    { userId: 'averageUser', date: '2015-09-24', nbEx: 6.1 },
    { userId: 'averageUser', date: '2015-09-08', nbEx: 7.3 },
    { userId: 'averageUser', date: '2015-09-07', nbEx: 10.2 },
    { userId: 'averageUser', date: '2013-03-13', nbEx: 12 },
    { userId: 'averageUser', date: '2014-03-11', nbEx: 13 },
    { userId: 'averageUser', date: '2014-03-12', nbEx: 18 },
    { userId: 'averageUser', date: '2012-12-09', nbEx: 2 },
    { userId: 'averageUser', date: '2012-11-02', nbEx: 4 },
    { userId: 'averageUser', date: '2012-11-01', nbEx: 32 },
    { userId: 'averageUser', date: '2012-10-31', nbEx: 12.5 },
    { userId: 'averageUser', date: '2012-10-30', nbEx: 14.5 },
    { userId: 'averageUser', date: '2015-06-01', nbEx: 23 },
    { userId: 'averageUser', date: '2015-06-23', nbEx: 22 },
    { userId: 'averageUser', date: '2015-07-21', nbEx: 33 },
    { userId: 'averageUser', date: '2013-07-30', nbEx: 7.7 },
    { userId: 'averageUser', date: '2013-09-06', nbEx: 14 },
    { userId: 'averageUser', date: '2013-09-02', nbEx: 1 },
    { userId: 'averageUser', date: '2013-05-31', nbEx: 5 },
    { userId: 'averageUser', date: '2013-05-17', nbEx: 4 },
    { userId: 'averageUser', date: '2013-05-20', nbEx: 5 },
    { userId: 'averageUser', date: '2014-10-23', nbEx: 15 },
    { userId: 'averageUser', date: '2013-03-14', nbEx: 2 },
    { userId: 'averageUser', date: '2014-01-14', nbEx: 15 },
    { userId: 'averageUser', date: '2014-01-15', nbEx: 4 },
    { userId: 'averageUser', date: '2014-01-16', nbEx: 1 },
    { userId: 'averageUser', date: '2015-10-19', nbEx: 15.3 },
    { userId: 'averageUser', date: '2013-03-06', nbEx: 10 },
    { userId: 'averageUser', date: '2013-03-07', nbEx: 15 },
    { userId: 'averageUser', date: '2013-03-11', nbEx: 4 },
    { userId: 'averageUser', date: '2013-03-16', nbEx: 6 },
    { userId: 'averageUser', date: '2013-03-21', nbEx: 4 },
    { userId: 'averageUser', date: '2015-07-27', nbEx: 17 },
    { userId: 'averageUser', date: '2015-07-28', nbEx: 19 },
    { userId: 'averageUser', date: '2015-03-12', nbEx: 6 },
    { userId: 'averageUser', date: '2015-03-13', nbEx: 8 },
    { userId: 'averageUser', date: '2014-10-30', nbEx: 7 },
    { userId: 'averageUser', date: '2014-11-10', nbEx: 2 },
    { userId: 'averageUser', date: '2014-11-11', nbEx: 2 },
    { userId: 'averageUser', date: '2013-05-16', nbEx: 17 },
    { userId: 'averageUser', date: '2013-05-19', nbEx: 19 },
    { userId: 'averageUser', date: '2013-09-08', nbEx: 8 },
    { userId: 'averageUser', date: '2013-09-09', nbEx: 1 },
    { userId: 'averageUser', date: '2013-09-10', nbEx: 4 },
    { userId: 'averageUser', date: '2012-10-23', nbEx: 14 },
    { userId: 'averageUser', date: '2012-10-22', nbEx: 12 },
    { userId: 'averageUser', date: '2012-10-24', nbEx: 19 },
    { userId: 'averageUser', date: '2014-03-06', nbEx: 14 },
    { userId: 'averageUser', date: '2014-03-08', nbEx: 6.5 },
    { userId: 'averageUser', date: '2014-06-14', nbEx: 10.5 },
    { userId: 'averageUser', date: '2014-06-16', nbEx: 5 },
    { userId: 'averageUser', date: '2014-06-09', nbEx: 4 },
    { userId: 'averageUser', date: '2014-06-10', nbEx: 13 },
    { userId: 'averageUser', date: '2014-06-12', nbEx: 4 },
    { userId: 'averageUser', date: '2013-08-07', nbEx: 13 },
    { userId: 'averageUser', date: '2013-08-12', nbEx: 15 },
    { userId: 'averageUser', date: '2013-08-13', nbEx: 3 },
    { userId: 'averageUser', date: '2013-08-14', nbEx: 4 },
    { userId: 'averageUser', date: '2013-08-20', nbEx: 4 },
    { userId: 'averageUser', date: '2013-07-24', nbEx: 12.5 },
    { userId: 'averageUser', date: '2013-07-23', nbEx: 5.3 },
    { userId: 'averageUser', date: '2015-07-29', nbEx: 5.5 },
    { userId: 'averageUser', date: '2013-10-30', nbEx: 1.5 },
    { userId: 'averageUser', date: '2013-10-28', nbEx: 7 },
    { userId: 'averageUser', date: '2013-10-29', nbEx: 7.5 },
    { userId: 'averageUser', date: '2013-08-05', nbEx: 16.5 },
    { userId: 'averageUser', date: '2013-08-08', nbEx: 3 },
    { userId: 'averageUser', date: '2013-08-03', nbEx: 3 },
    { userId: 'averageUser', date: '2013-08-09', nbEx: 7 },
    { userId: 'averageUser', date: '2013-08-02', nbEx: 3 },
    { userId: 'averageUser', date: '2013-07-29', nbEx: 13 },
    { userId: 'averageUser', date: '2013-07-31', nbEx: 15 },
    { userId: 'averageUser', date: '2013-08-01', nbEx: 8 },
    { userId: 'averageUser', date: '2013-08-04', nbEx: 5 },
    { userId: 'averageUser', date: '2014-06-11', nbEx: 10 },
    { userId: 'averageUser', date: '2014-06-13', nbEx: 9 },
    { userId: 'averageUser', date: '2014-06-02', nbEx: 4 },
    { userId: 'averageUser', date: '2014-06-15', nbEx: 7 },
    { userId: 'averageUser', date: '2013-09-01', nbEx: 40 },
    { userId: 'averageUser', date: '2013-09-03', nbEx: 8 },
    { userId: 'averageUser', date: '2014-09-10', nbEx: 32 },
    { userId: 'averageUser', date: '2014-09-09', nbEx: 7 },
    { userId: 'averageUser', date: '2014-09-11', nbEx: 3 },
    { userId: 'averageUser', date: '2014-10-21', nbEx: 19.9 },
    { userId: 'averageUser', date: '2013-11-19', nbEx: 6 },
    { userId: 'averageUser', date: '2013-11-26', nbEx: 3.5 },
    { userId: 'averageUser', date: '2013-11-29', nbEx: 7 },
    { userId: 'averageUser', date: '2013-11-18', nbEx: 4 },
    { userId: 'averageUser', date: '2013-11-20', nbEx: 7.5 },
    { userId: 'averageUser', date: '2013-11-22', nbEx: 4.3 },
    { userId: 'averageUser', date: '2013-12-08', nbEx: 1 },
    { userId: 'averageUser', date: '2013-12-03', nbEx: 4 },
    { userId: 'averageUser', date: '2013-12-09', nbEx: 1 },
    { userId: 'averageUser', date: '2014-12-14', nbEx: 15.9 },
    { userId: 'averageUser', date: '2013-11-21', nbEx: 10 },
    { userId: 'averageUser', date: '2013-09-22', nbEx: 19 },
    { userId: 'averageUser', date: '2013-09-21', nbEx: 12 },
    { userId: 'averageUser', date: '2013-09-23', nbEx: 11 },
    { userId: 'averageUser', date: '2013-09-27', nbEx: 16 },
    { userId: 'averageUser', date: '2013-09-28', nbEx: 17 },
    { userId: 'averageUser', date: '2013-10-22', nbEx: 5 },
    { userId: 'averageUser', date: '2013-10-24', nbEx: 10 },
    { userId: 'averageUser', date: '2013-10-23', nbEx: 6 },
    { userId: 'averageUser', date: '2013-10-19', nbEx: 4 },
    { userId: 'averageUser', date: '2013-10-21', nbEx: 5 },
    { userId: 'averageUser', date: '2013-10-25', nbEx: 6 },
    { userId: 'averageUser', date: '2014-01-22', nbEx: 1 },
    { userId: 'averageUser', date: '2014-01-25', nbEx: 10 },
    { userId: 'averageUser', date: '2014-01-08', nbEx: 15 },
    { userId: 'averageUser', date: '2014-01-10', nbEx: 4 },
    { userId: 'averageUser', date: '2014-01-28', nbEx: 2 },
    { userId: 'averageUser', date: '2014-05-13', nbEx: 16 },
    { userId: 'averageUser', date: '2014-05-14', nbEx: 14 },
    { userId: 'averageUser', date: '2014-05-15', nbEx: 7 },
    { userId: 'averageUser', date: '2014-05-21', nbEx: 4 },
    { userId: 'averageUser', date: '2014-05-18', nbEx: 3 },
    { userId: 'averageUser', date: '2016-03-16', nbEx: 7.2 },
    { userId: 'averageUser', date: '2016-03-17', nbEx: 8.1 },
    { userId: 'averageUser', date: '2016-03-23', nbEx: 6.3 },
    { userId: 'averageUser', date: '2016-03-31', nbEx: 4.7 },
    { userId: 'averageUser', date: '2016-04-01', nbEx: 3.5 },
    { userId: 'averageUser', date: '2016-04-04', nbEx: 8.4 },
    { userId: 'averageUser', date: '2016-04-05', nbEx: 6.1 },
    { userId: 'averageUser', date: '2016-04-07', nbEx: 5.1 },
    { userId: 'averageUser', date: '2014-12-15', nbEx: 16 },
    { userId: 'averageUser', date: '2014-03-21', nbEx: 19 },
    { userId: 'averageUser', date: '2014-03-19', nbEx: 4 },
    { userId: 'averageUser', date: '2014-03-24', nbEx: 1 },
    { userId: 'averageUser', date: '2014-03-25', nbEx: 3 },
    { userId: 'averageUser', date: '2014-10-10', nbEx: 16 },
    { userId: 'averageUser', date: '2014-10-12', nbEx: 4 },
    { userId: 'averageUser', date: '2015-05-07', nbEx: 18.3 },
    { userId: 'averageUser', date: '2014-11-03', nbEx: 25 },
    { userId: 'averageUser', date: '2014-10-29', nbEx: 3 },
    { userId: 'averageUser', date: '2014-10-28', nbEx: 4 },
    { userId: 'averageUser', date: '2014-02-28', nbEx: 31 },
    { userId: 'averageUser', date: '2014-02-27', nbEx: 7 },
    { userId: 'averageUser', date: '2014-06-18', nbEx: 22 },
    { userId: 'averageUser', date: '2014-09-02', nbEx: 8 },
    { userId: 'averageUser', date: '2014-09-03', nbEx: 8 },
    { userId: 'averageUser', date: '2014-09-04', nbEx: 4 },
    { userId: 'averageUser', date: '2014-10-20', nbEx: 25.3 },
    { userId: 'averageUser', date: '2014-12-11', nbEx: 17.1 },
    { userId: 'averageUser', date: '2014-12-10', nbEx: 6.5 },
    { userId: 'averageUser', date: '2014-08-20', nbEx: 45 },
    { userId: 'averageUser', date: '2014-08-21', nbEx: 15 },
    { userId: 'averageUser', date: '2014-10-16', nbEx: 14.8 },
    { userId: 'averageUser', date: '2014-12-13', nbEx: 14.3 },
    { userId: 'averageUser', date: '2014-10-18', nbEx: 24.4 },
    { userId: 'averageUser', date: '2014-10-17', nbEx: 6.3 },
    { userId: 'averageUser', date: '2015-05-05', nbEx: 11.4 },
    { userId: 'averageUser', date: '2015-05-06', nbEx: 13.7 },
    { userId: 'averageUser', date: '2014-12-16', nbEx: 31.5 },
    { userId: 'averageUser', date: '2014-10-13', nbEx: 42 },
    { userId: 'averageUser', date: '2014-10-15', nbEx: 16 },
    { userId: 'averageUser', date: '2014-12-12', nbEx: 13.8 },
    { userId: 'averageUser', date: '2014-10-19', nbEx: 13.9 },
    { userId: 'averageUser', date: '2015-10-18', nbEx: 14.3 },
    { userId: 'averageUser', date: '2015-09-03', nbEx: 4.9 },
    { userId: 'averageUser', date: '2015-09-01', nbEx: 10.8 },
    { userId: 'averageUser', date: '2014-10-14', nbEx: 3.5 },
    { userId: 'averageUser', date: '2014-10-26', nbEx: 17 },
    { userId: 'averageUser', date: '2014-10-27', nbEx: 28 },
    { userId: 'averageUser', date: '2015-02-24', nbEx: 22 },
    { userId: 'averageUser', date: '2015-02-26', nbEx: 15.8 },
    { userId: 'averageUser', date: '2015-02-25', nbEx: 8 },
    { userId: 'averageUser', date: '2015-08-31', nbEx: 11.5 },
    { userId: 'averageUser', date: '2015-03-05', nbEx: 12.5 },
    { userId: 'averageUser', date: '2015-03-06', nbEx: 5.3 },
    { userId: 'averageUser', date: '2015-04-27', nbEx: 13 },
    { userId: 'averageUser', date: '2016-04-02', nbEx: 4.7 },
    { userId: 'averageUser', date: '2016-04-03', nbEx: 5.3 },
    { userId: 'averageUser', date: '2016-03-09', nbEx: 6.8 },
    { userId: 'averageUser', date: '2015-05-02', nbEx: 22.3 },
    { userId: 'averageUser', date: '2015-04-28', nbEx: 16 },
    { userId: 'averageUser', date: '2015-01-15', nbEx: 35 },
    { userId: 'averageUser', date: '2015-01-16', nbEx: 7 },
    { userId: 'averageUser', date: '2015-01-17', nbEx: 15 },
    { userId: 'averageUser', date: '2015-01-18', nbEx: 2 },
    { userId: 'averageUser', date: '2015-09-06', nbEx: 17.3 },
    { userId: 'averageUser', date: '2015-09-20', nbEx: 6.9 },
    { userId: 'averageUser', date: '2016-03-29', nbEx: 3.9 },
    { userId: 'averageUser', date: '2016-03-30', nbEx: 3.9 },
    { userId: 'averageUser', date: '2016-03-14', nbEx: 8.8 },
    { userId: 'averageUser', date: '2016-03-15', nbEx: 6.3 },
    { userId: 'averageUser', date: '2015-04-30', nbEx: 13.8 },
    { userId: 'averageUser', date: '2015-03-11', nbEx: 4 },
    { userId: 'averageUser', date: '2015-05-14', nbEx: 37 },
    { userId: 'averageUser', date: '2015-05-15', nbEx: 15 },
    { userId: 'averageUser', date: '2015-05-16', nbEx: 6 },
    { userId: 'averageUser', date: '2015-09-15', nbEx: 17 },
    { userId: 'averageUser', date: '2015-09-14', nbEx: 5.8 },
    { userId: 'averageUser', date: '2015-03-17', nbEx: 16 },
    { userId: 'averageUser', date: '2015-07-16', nbEx: 16 },
    { userId: 'averageUser', date: '2015-07-18', nbEx: 10 },
    { userId: 'averageUser', date: '2015-07-19', nbEx: 16 },
    { userId: 'averageUser', date: '2015-08-29', nbEx: 10.6 },
    { userId: 'averageUser', date: '2016-03-10', nbEx: 5.3 },
    { userId: 'averageUser', date: '2015-10-16', nbEx: 10.1 },
    { userId: 'averageUser', date: '2015-10-17', nbEx: 12.2 },
    { userId: 'averageUser', date: '2015-12-16', nbEx: 17.1 },
    { userId: 'averageUser', date: '2016-03-08', nbEx: 3.4 },
    { userId: 'averageUser', date: '2015-10-15', nbEx: 14.1 },
    { userId: 'averageUser', date: '2015-12-18', nbEx: 52 },
    { userId: 'averageUser', date: '2015-10-14', nbEx: 8.6 },
    { userId: 'averageUser', date: '2015-10-13', nbEx: 7.4 },
    { userId: 'averageUser', date: '2015-12-17', nbEx: 25.3 },
    { userId: 'averageUser', date: '2015-09-17', nbEx: 8.4 },
    { userId: 'averageUser', date: '2015-10-03', nbEx: 13.6 },
    { userId: 'averageUser', date: '2015-09-18', nbEx: 17.9 },
    { userId: 'averageUser', date: '2015-10-04', nbEx: 11.3 },
    { userId: 'averageUser', date: '2013-10-15', nbEx: 8 },
    { userId: 'averageUser', date: '2013-10-14', nbEx: 1 },
    { userId: 'averageUser', date: '2013-08-06', nbEx: 9 },
    { userId: 'averageUser', date: '2013-11-04', nbEx: 12 },
    { userId: 'averageUser', date: '2013-11-27', nbEx: 8 },
    { userId: 'averageUser', date: '2013-11-28', nbEx: 5 },
    { userId: 'averageUser', date: '2013-11-24', nbEx: 6 },
    { userId: 'averageUser', date: '2013-11-25', nbEx: 10 },
    { userId: 'averageUser', date: '2012-10-29', nbEx: 6 },
    { userId: 'averageUser', date: '2012-10-28', nbEx: 12 },
    { userId: 'averageUser', date: '2014-11-18', nbEx: 7 },
    { userId: 'averageUser', date: '2015-04-29', nbEx: 13.2 },
    { userId: 'averageUser', date: '2014-08-05', nbEx: 4 },
    { userId: 'averageUser', date: '2014-12-26', nbEx: 8 },
    { userId: 'averageUser', date: '2014-12-27', nbEx: 5 },
    { userId: 'averageUser', date: '2014-08-12', nbEx: 7 },
    { userId: 'averageUser', date: '2014-12-07', nbEx: 9 },
    { userId: 'averageUser', date: '2012-11-22', nbEx: 4 },
    { userId: 'averageUser', date: '2013-01-17', nbEx: 4 },
    { userId: 'averageUser', date: '2012-11-07', nbEx: 4 },
    { userId: 'averageUser', date: '2013-06-30', nbEx: 1 },
    { userId: 'averageUser', date: '2013-06-29', nbEx: 3 },
    { userId: 'averageUser', date: '2013-04-05', nbEx: 4 },
    { userId: 'averageUser', date: '2015-03-07', nbEx: 4 },
    { userId: 'averageUser', date: '2015-05-12', nbEx: 4 },
    { userId: 'averageUser', date: '2013-01-18', nbEx: 3 },
    { userId: 'averageUser', date: '2014-03-13', nbEx: 3 },
    { userId: 'averageUser', date: '2014-12-09', nbEx: 8 },
    { userId: 'averageUser', date: '2016-03-27', nbEx: 4.6 },
    { userId: 'averageUser', date: '2014-12-08', nbEx: 30 },
    { userId: 'averageUser', date: '2015-01-12', nbEx: 30 },
    { userId: 'averageUser', date: '2015-09-05', nbEx: 12.6 },
    { userId: 'averageUser', date: '2015-05-10', nbEx: 9 },
    { userId: 'averageUser', date: '2015-05-11', nbEx: 1 },
    { userId: 'averageUser', date: '2015-09-04', nbEx: 6.7 },
    { userId: 'averageUser', date: '2015-09-09', nbEx: 11.1 },
    { userId: 'averageUser', date: '2013-12-17', nbEx: 5 },
    { userId: 'averageUser', date: '2015-09-12', nbEx: 34.5 },
    { userId: 'averageUser', date: '2015-09-19', nbEx: 11.1 },
    { userId: 'averageUser', date: '2015-06-25', nbEx: 2 },
    { userId: 'averageUser', date: '2015-08-27', nbEx: 6.1 },
    { userId: 'averageUser', date: '2015-08-19', nbEx: 1 },
    { userId: 'averageUser', date: '2015-08-22', nbEx: 3 },
    { userId: 'averageUser', date: '2015-08-23', nbEx: 6 },
    { userId: 'averageUser', date: '2015-08-30', nbEx: 5.2 },
    { userId: 'averageUser', date: '2015-08-24', nbEx: 10.1 },
    { userId: 'averageUser', date: '2015-08-28', nbEx: 12.7 },
    { userId: 'averageUser', date: '2015-09-13', nbEx: 12.9 },
    { userId: 'averageUser', date: '2015-09-11', nbEx: 4.3 },
    { userId: 'averageUser', date: '2015-09-29', nbEx: 7.2 },
    { userId: 'averageUser', date: '2015-09-30', nbEx: 12.3 },
    { userId: 'averageUser', date: '2015-10-07', nbEx: 7 },
    { userId: 'averageUser', date: '2015-08-26', nbEx: 16.8 },
    { userId: 'averageUser', date: '2015-10-02', nbEx: 9 },
    { userId: 'averageUser', date: '2015-08-25', nbEx: 12.4 },
    { userId: 'averageUser', date: '2015-09-02', nbEx: 8.3 },
    { userId: 'averageUser', date: '2015-10-05', nbEx: 10.1 },
    { userId: 'averageUser', date: '2015-09-25', nbEx: 8.6 },
    { userId: 'averageUser', date: '2015-09-26', nbEx: 7.5 },
    { userId: 'averageUser', date: '2015-10-06', nbEx: 6.6 },
    { userId: 'averageUser', date: '2015-10-10', nbEx: 11.7 },
    { userId: 'averageUser', date: '2015-10-11', nbEx: 14.2 },
    { userId: 'averageUser', date: '2015-09-27', nbEx: 10 },
    { userId: 'averageUser', date: '2015-10-08', nbEx: 7.4 },
    { userId: 'averageUser', date: '2015-10-09', nbEx: 19.5 },
    { userId: 'averageUser', date: '2015-10-12', nbEx: 29.6 },
    { userId: 'averageUser', date: '2015-09-16', nbEx: 14.1 },
    { userId: 'averageUser', date: '2015-10-01', nbEx: 15.9 },
    { userId: 'averageUser', date: '2015-08-21', nbEx: 48 },
    { userId: 'averageUser', date: '2015-09-28', nbEx: 21.2 } ];

var url = 'mongodb://alicia:aliciamongo@ds013579.mlab.com:13579/personal-dashboard';
MongoClient.connect(url, function(err, db) {
    assert.equal(null, err);
    //console.log("Connected correctly to server");
    remove(db, averageUser, (result) => {
        test5(db, averageUser, (result) =>{
            db.close();
        })
    })
});
var test = function(db, body, callback){
    var collection = db.collection("prefs");
    collection.update(
        {user_id:"alicia"},
        {"user_id" : "alicia","course_id": 22, "hidden":true},
        {upsert:true},
        function(err, result){
            callback(result);
        }
    )
}

var test2 = function(db, user_id, course_id, callback){
    var collection = db.collection("prefs");
    collection.find(
        //Selection
        {$and : [{user_id : {$eq : user_id}},
            {course_id : {$eq : course_id}}]}/*,
         //Projection
         {course_id:1, _id:0}
         ).toArray(function(err,res){
         callback(res);
         }*/)
}

var test3 = function(db, user_id, course_id, callback){
    var collection = db.collection("prefs");
    collection.remove(
        {user_id:user_id, course_id:course_id},
        function(err, result){
            console.log("Updated course to false to collection");
            callback(result);
        })
}
var test4 = function (db, user_id, callback){
    var collection = db.collection("activity");
    collection.find(
        //Selection
        {userId : {$eq : user_id}},
        //Projection
        {date:1, nbEx:1, _id:0})
        .toArray(function(err,res){
            callback(res);
        });
}

var remove = function(db, docs, callback){
    var collection = db.collection("activity");
    collection.remove(
        {userId : docs[0].userId},
        (err,res) =>{
            if(err){
                console.log(err);
            }
            else{
                console.log("res")
                console.log(res.result);
                callback(res);
            }

        })

}

var test5 =  function (db, docs, callback){
    var collection = db.collection("activity");
    var error, result;
    collection.insert(
        docs,
        function(err, res){
            if(err){
                console.log("err")
                console.log(err);
                error = err
            }
            else{
                result = res;
                console.log("NO ERR");
                callback(result);
            }
        }
    )

}